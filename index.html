<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Rsa by Franciscodesign</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Rsa</h1>
        <p>Cryptography‬</p>

        <p class="view"><a href="https://github.com/Franciscodesign/RSA">View the Project on GitHub <small>Franciscodesign/RSA</small></a></p>


        <ul>
          <li><a href="https://github.com/Franciscodesign/RSA/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/Franciscodesign/RSA/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/Franciscodesign/RSA">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h3>
<a id="welcome-to-github-pages" class="anchor" href="#welcome-to-github-pages" aria-hidden="true"><span class="octicon octicon-link"></span></a>Welcome to GitHub Pages.</h3>

<h3>
<a id="progam-1-rsa" class="anchor" href="#progam-1-rsa" aria-hidden="true"><span class="octicon octicon-link"></span></a>Progam 1: <strong><a href="http://en.wikipedia.org/wiki/RSA_problem">RSA</a></strong>
</h3>

<p>Chương trình cài đặt hàm cửa sập RSA thỏa mãn:</p>

<ul>
<li>Các số nguyên tố <code>p, q</code> là số <code>3072</code> bits, có nghĩa rằng modulo <code>N</code> khoảng <code>6142</code> bits.
&gt; Chú ý: Trên thực tế N khoảng 2048 bit là đủ an toàn. Ở đây ta sử dụng số N lớn chỉ nhằm để test hiệu năng chương trình.</li>
<li>Khóa bí mật <code>(N, d)</code> thỏa mãn <code>d &gt; N^(1/4)</code>.</li>
<li>Khóa công khai <code>(N, e)</code> thỏa mãn <code>e &gt; 3</code>.
<br><br>
<strong>Thuật toán</strong><br>
<strong>RSA Encode</strong> <code>((N, e),m)</code><br>
Input:<br>
</li>
<li>
<code>(N,e)</code>   RSA public key</li>
<li>
<code>m</code>   message representative, an integer between <code>0</code> and <code>N-1</code>
<br>Output: <br> c   ciphertext representative, an integer between <code>0</code> and <code>N-1</code>
</li>
</ul>

<p><strong>Encode</strong>:</p>

<div class="highlight highlight-java"><pre>        p <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-stj">GenPrime</span>()<span class="pl-k">.</span>genPrime(bitlen<span class="pl-k">/</span><span class="pl-c1">2</span>);
        q <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-stj">GenPrime</span>()<span class="pl-k">.</span>genPrime(bitlen<span class="pl-k">/</span><span class="pl-c1">2</span>);
        n <span class="pl-k">=</span> p<span class="pl-k">.</span>multiply(q);
        <span class="pl-stj">BigInteger</span> m <span class="pl-k">=</span> (p<span class="pl-k">.</span>subtract(<span class="pl-stj">BigInteger</span><span class="pl-c1"><span class="pl-k">.</span>ONE</span>))<span class="pl-k">.</span>multiply(q
                .subtract(<span class="pl-stj">BigInteger</span><span class="pl-c1"><span class="pl-k">.</span>ONE</span>)); <span class="pl-c">// m = (p-1) * (q-1)</span>

        e <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-stj">BigInteger</span>(<span class="pl-s1"><span class="pl-pds">"</span>3<span class="pl-pds">"</span></span>);
        <span class="pl-k">while</span> (m<span class="pl-k">.</span>gcd(e)<span class="pl-k">.</span>intValue() <span class="pl-k">&gt;</span> <span class="pl-c1">1</span>) {
            e <span class="pl-k">=</span> e<span class="pl-k">.</span>add(<span class="pl-k">new</span> <span class="pl-stj">BigInteger</span>(<span class="pl-s1"><span class="pl-pds">"</span>2<span class="pl-pds">"</span></span>));
        }
        d <span class="pl-k">=</span> e<span class="pl-k">.</span>modInverse(m);</pre></div>

<p><strong>Decode</strong> <img class="emoji" title=":boom:" alt=":boom:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f4a5.png" height="20" width="20" align="absmiddle"> <img class="emoji" title=":boom:" alt=":boom:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f4a5.png" height="20" width="20" align="absmiddle"> <img class="emoji" title=":boom:" alt=":boom:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f4a5.png" height="20" width="20" align="absmiddle"></p>

<div class="highlight highlight-java"><pre>    <span class="pl-s">public</span> <span class="pl-s">synchronized</span> <span class="pl-stj">String</span> decrypt(<span class="pl-stj">String</span> message) {
        <span class="pl-k">return</span> <span class="pl-k">new</span> <span class="pl-stj">String</span>((<span class="pl-k">new</span> <span class="pl-stj">BigInteger</span>(message))<span class="pl-k">.</span>modPow(d, n)<span class="pl-k">.</span>toByteArray());
    }</pre></div>

<hr>

<h3>
<a id="progam-2-probable-prime" class="anchor" href="#progam-2-probable-prime" aria-hidden="true"><span class="octicon octicon-link"></span></a>Progam 2: Probable Prime</h3>

<p>Dùng giải thuật <a href="http://en.wikipedia.org/wiki/Miller%E2%80%93Rabin_primality_test">Miller-Rabin</a>
<br></p>

<pre><code>Input: n &gt; 3, an odd integer to be tested for primality;
Input: k, a parameter that determines the accuracy of the test
Output: composite if n is composite, otherwise probably prime
write n − 1 as 2^s*d with d odd by factoring powers of 2 from n − 1
WitnessLoop: repeat k times:
   pick a random integer a in the range [2, n − 2]
   x ← a^d mod n
   if x = 1 or x = n − 1 then do next WitnessLoop
   repeat s − 1 times:
      x &lt;- x^2 mod n
      if x = 1 then return composite
      if x = n − 1 then do next WitnessLoop
   return composite
return probably prime
</code></pre>

<p><strong>Code</strong> <br></p>

<div class="highlight highlight-java"><pre><span class="pl-s">public</span> <span class="pl-s">static</span> <span class="pl-st">boolean</span> millerRabin(<span class="pl-stj">BigInteger</span> n, <span class="pl-st">int</span> numValues) { 
        <span class="pl-stj">BigInteger</span> d <span class="pl-k">=</span> n<span class="pl-k">.</span>subtract(<span class="pl-c1">ONE</span>);
        <span class="pl-st">int</span> s <span class="pl-k">=</span> <span class="pl-c1">0</span>;
        <span class="pl-k">while</span> (d<span class="pl-k">.</span>mod(<span class="pl-c1">TWO</span>)<span class="pl-k">.</span>equals(<span class="pl-c1">ZERO</span>)) {
            s<span class="pl-k">++</span>;
            d <span class="pl-k">=</span> d<span class="pl-k">.</span>divide(<span class="pl-c1">TWO</span>);
        }

        <span class="pl-k">for</span> (<span class="pl-st">int</span> i <span class="pl-k">=</span> <span class="pl-c1">0</span>; i <span class="pl-k">&lt;</span> aValues<span class="pl-k">.</span>length; i<span class="pl-k">++</span>) {
            <span class="pl-k">if</span>(n<span class="pl-k">.</span>compareTo(<span class="pl-stj">BigInteger</span><span class="pl-k">.</span>valueOf(aValues[i]))<span class="pl-k">==</span><span class="pl-c1">0</span>)
                <span class="pl-k">return</span> <span class="pl-c1">true</span>;
            <span class="pl-k">if</span> (n<span class="pl-k">.</span>mod(<span class="pl-stj">BigInteger</span><span class="pl-k">.</span>valueOf(aValues[i]))
                    .compareTo(<span class="pl-stj">BigInteger</span><span class="pl-c1"><span class="pl-k">.</span>ZERO</span>) <span class="pl-k">==</span> <span class="pl-c1">0</span>)
                <span class="pl-k">return</span> <span class="pl-c1">false</span>;
        }

        <span class="pl-stj">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(<span class="pl-s1"><span class="pl-pds">"</span>Base Over<span class="pl-pds">"</span></span>);
        <span class="pl-k">for</span> (<span class="pl-st">int</span> i <span class="pl-k">=</span> <span class="pl-c1">0</span>; i <span class="pl-k">&lt;</span> numValues; i<span class="pl-k">++</span>) {
            <span class="pl-c">//BigInteger a = BigInteger.valueOf(aValues[i]);// random</span>
            <span class="pl-stj">BigInteger</span> a <span class="pl-k">=</span>  randomBigInteger(n);
            <span class="pl-st">boolean</span> r <span class="pl-k">=</span> testPrime(n, a, s, d);
            <span class="pl-k">if</span> (<span class="pl-k">!</span>r) {
                <span class="pl-k">return</span> <span class="pl-c1">false</span>;
            }
        }
        <span class="pl-k">return</span> <span class="pl-c1">true</span>;
    }</pre></div>

<hr>

<h3>
<a id="progam-3-chia-sẻ-file" class="anchor" href="#progam-3-chia-s%E1%BA%BB-file" aria-hidden="true"><span class="octicon octicon-link"></span></a>Progam 3: Chia sẻ file</h3>

<p>Xây dựng chương trình mã hóa file cho phép nhiều người dùng có thể giải mã.
<br>Giả sử người dùng <strong>A</strong> muốn mã hóa file <em>f</em> cho phép cả người dùng <strong>B</strong> và <strong>C</strong> có thể giải mã. Chị ta làm như sau:</p>

<ul>
<li>Sinh ngẫu nhiên khóa <code>k</code> và mã hoá file <em>f</em> dùng hệ mã đối xứng an toàn <code>(E, D)</code>. Ta được file
<br>                 <code>g = E(k, f)</code>
&gt; Ví dụ: <strong>E</strong> có thể là <code>AES-CBC mode</code> hoặc <code>AES-CRT mode</code>.</li>
<li>Dùng sở đồ <code>RSA-OAEP</code> với khóa công khai của người dùng <strong>A</strong>, <strong>B</strong> và <strong>C</strong> để mã hóa khóa <code>k</code>
thành <code>kA</code>, <code>kB</code> và <code>kC</code>, tương ứng cho mỗi người. Ghép file <code>g</code> với <code>kA</code>, <code>kB</code> và <code>kC</code> ta được file
<br>                 <code>x = g‖kA‖kB‖kC</code>
<br>Người dùng <strong>B</strong> (tương ứng <strong>C</strong>) có thể tính <code>k</code> từ file <code>x</code> và khóa bí mật <code>kB</code> (tương ứng <code>kC</code> ). Từ đó
chị ta giải mã <code>f = D(k, g)</code>.</li>
</ul>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/Franciscodesign">Franciscodesign</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>