<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Rsa by Franciscodesign</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
  <div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=810117602334589&version=v2.0";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

    <div class="wrapper">
      <header>
        <h1>Rsa</h1>
        <p>Cryptography‬</p>

        <p class="view"><a href="https://github.com/Franciscodesign/RSA">View the Project on GitHub <small>Franciscodesign/RSA</small></a></p>


        <ul>
          <li><a href="https://github.com/Franciscodesign/RSA/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/Franciscodesign/RSA/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/Franciscodesign/RSA">View On <strong>GitHub</strong></a></li>
        </ul>
        
        <img src="https://lh6.googleusercontent.com/-MUCaQhVHmvM/VHX54qAuwaI/AAAAAAAABtM/Vq9h8nqjEiw/w590-h591-no/IMG_8117.jpg">
        <div class="fb-comments" data-href="http://franciscodesign.github.io/RSA//" data-width="270" data-numposts="5" data-colorscheme="light"></div>
      </header>
      <section>
        <h3>
<a id="welcome-to-github-pages" class="anchor" href="#welcome-to-github-pages" aria-hidden="true"><span class="octicon octicon-link"></span></a>Welcome to GitHub Pages.</h3>
<img class="emoji" title=":evergreen_tree:" alt=":evergreen_tree:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f332.png" height="20" width="20" align="absmiddle">
<img class="emoji" title=":evergreen_tree:" alt=":evergreen_tree:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f332.png" height="20" width="20" align="absmiddle">
<img class="emoji" title=":bell:" alt=":bell:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f514.png" height="20" width="20" align="absmiddle">
<img class="emoji" title=":bell:" alt=":bell:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f514.png" height="20" width="20" align="absmiddle">
<img class="emoji" title=":santa:" alt=":santa:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f385.png" height="20" width="20" align="absmiddle">
<img class="emoji" title=":gift:" alt=":gift:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f381.png" height="20" width="20" align="absmiddle">
<img class="emoji" title=":bell:" alt=":bell:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f514.png" height="20" width="20" align="absmiddle">
<img class="emoji" title=":bell:" alt=":bell:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f514.png" height="20" width="20" align="absmiddle">
<img class="emoji" title=":evergreen_tree:" alt=":evergreen_tree:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f332.png" height="20" width="20" align="absmiddle">
<img class="emoji" title=":evergreen_tree:" alt=":evergreen_tree:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f332.png" height="20" width="20" align="absmiddle">
<hr>


<h3>
<a id="progam-1-rsa" class="anchor" href="#progam-1-rsa" aria-hidden="true"><span class="octicon octicon-link"></span></a>Progam 1: <strong><a href="http://en.wikipedia.org/wiki/RSA_problem">RSA</a></strong>
</h3>

<p>Chương trình cài đặt hàm cửa sập RSA thỏa mãn:</p>

<ul>
<li>Các số nguyên tố <code>p, q</code> là số <code>3072</code> bits, có nghĩa rằng modulo <code>N</code> khoảng <code>6142</code> bits.
&gt; Chú ý: Trên thực tế N khoảng 2048 bit là đủ an toàn. Ở đây ta sử dụng số N lớn chỉ nhằm để test hiệu năng chương trình.</li>
<li>Khóa bí mật <code>(N, d)</code> thỏa mãn <code>d &gt; N^(1/4)</code>.</li>
<li>Khóa công khai <code>(N, e)</code> thỏa mãn <code>e &gt; 3</code>.
<br><br>
<strong>Thuật toán</strong><br>
<strong>RSA Encode</strong> <code>((N, e),m)</code><br>
Input:<br>
</li>
<li>
<code>(N,e)</code>   RSA public key</li>
<li>
<code>m</code>   message representative, an integer between <code>0</code> and <code>N-1</code>
<br>Output: <br> c   ciphertext representative, an integer between <code>0</code> and <code>N-1</code>
</li>
</ul>

<p><strong>Encode</strong>:</p>

<div class="highlight highlight-javascript"><pre>        p <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">GenPrime</span>().genPrime(bitlen/<span class="pl-c1">2</span>);
        q <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">GenPrime</span>().genPrime(bitlen/<span class="pl-c1">2</span>);
        n <span class="pl-k">=</span> p.multiply(q);
        BigInteger m <span class="pl-k">=</span> (p.subtract(BigInteger.ONE)).multiply(q
                .subtract(BigInteger.ONE)); <span class="pl-c">// m = (p-1) * (q-1)</span>

        e <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">BigInteger</span>(<span class="pl-s1"><span class="pl-pds">"</span>3<span class="pl-pds">"</span></span>);
        <span class="pl-k">while</span> (m.gcd(e).intValue() <span class="pl-k">&gt;</span> <span class="pl-c1">1</span>) {
            e <span class="pl-k">=</span> e.<span class="pl-s3">add</span>(<span class="pl-k">new</span> <span class="pl-en">BigInteger</span>(<span class="pl-s1"><span class="pl-pds">"</span>2<span class="pl-pds">"</span></span>));
        }
        d <span class="pl-k">=</span> e.modInverse(m);</pre></div>

<p><strong>Decode</strong> <img class="emoji" title=":boom:" alt=":boom:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f4a5.png" height="20" width="20" align="absmiddle"> <img class="emoji" title=":boom:" alt=":boom:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f4a5.png" height="20" width="20" align="absmiddle"> <img class="emoji" title=":boom:" alt=":boom:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f4a5.png" height="20" width="20" align="absmiddle"></p>

<div class="highlight highlight-javascript"><pre>    <span class="pl-s">public</span> synchronized <span class="pl-s3">String</span> decrypt(<span class="pl-s3">String</span> message) {
        <span class="pl-k">return</span> <span class="pl-k">new</span> <span class="pl-en">String</span>((<span class="pl-k">new</span> <span class="pl-en">BigInteger</span>(message)).modPow(d, n).toByteArray());
    }</pre></div>

<hr>

<h3>
<a id="progam-2-probable-prime" class="anchor" href="#progam-2-probable-prime" aria-hidden="true"><span class="octicon octicon-link"></span></a>Progam 2: Probable Prime</h3>

<p>Dùng giải thuật <a href="http://en.wikipedia.org/wiki/Miller%E2%80%93Rabin_primality_test">Miller-Rabin</a>
<br></p>

<pre><code>Input: n &gt; 3, an odd integer to be tested for primality;
Input: k, a parameter that determines the accuracy of the test
Output: composite if n is composite, otherwise probably prime
write n − 1 as 2^s*d with d odd by factoring powers of 2 from n − 1
WitnessLoop: repeat k times:
   pick a random integer a in the range [2, n − 2]
   x ← a^d mod n
   if x = 1 or x = n − 1 then do next WitnessLoop
   repeat s − 1 times:
      x &lt;- x^2 mod n
      if x = 1 then return composite
      if x = n − 1 then do next WitnessLoop
   return composite
return probably prime
</code></pre>

<p><strong>Code</strong> <br></p>

<div class="highlight highlight-javascript"><pre>       <span class="pl-s">public</span> <span class="pl-s">static</span> boolean millerRabin(BigInteger n, int numValues) { 
        BigInteger d <span class="pl-k">=</span> n.subtract(ONE);
        int s <span class="pl-k">=</span> <span class="pl-c1">0</span>;
        <span class="pl-k">while</span> (d.mod(TWO).equals(ZERO)) {
            s<span class="pl-k">++</span>;
            d <span class="pl-k">=</span> d.divide(TWO);
        }

        <span class="pl-k">for</span> (int i <span class="pl-k">=</span> <span class="pl-c1">0</span>; i <span class="pl-k">&lt;</span> aValues.<span class="pl-sc">length</span>; i<span class="pl-k">++</span>) {
            <span class="pl-k">if</span>(n.compareTo(BigInteger.<span class="pl-s3">valueOf</span>(aValues[i]))<span class="pl-k">==</span><span class="pl-c1">0</span>)
                <span class="pl-k">return</span> <span class="pl-c1">true</span>;
            <span class="pl-k">if</span> (n.mod(BigInteger.<span class="pl-s3">valueOf</span>(aValues[i]))
                    .compareTo(BigInteger.ZERO) <span class="pl-k">==</span> <span class="pl-c1">0</span>)
                <span class="pl-k">return</span> <span class="pl-c1">false</span>;
        }

        System.out.println(<span class="pl-s1"><span class="pl-pds">"</span>Base Over<span class="pl-pds">"</span></span>);
        <span class="pl-k">for</span> (int i <span class="pl-k">=</span> <span class="pl-c1">0</span>; i <span class="pl-k">&lt;</span> numValues; i<span class="pl-k">++</span>) {
            <span class="pl-c">//BigInteger a = BigInteger.valueOf(aValues[i]);// random</span>
            BigInteger a <span class="pl-k">=</span>  randomBigInteger(n);
            boolean r <span class="pl-k">=</span> testPrime(n, a, s, d);
            <span class="pl-k">if</span> (<span class="pl-k">!</span>r) {
                <span class="pl-k">return</span> <span class="pl-c1">false</span>;
            }
        }
        <span class="pl-k">return</span> <span class="pl-c1">true</span>;
    }</pre></div>

<hr>

<h3>
<a id="progam-3-chia-sẻ-file" class="anchor" href="#progam-3-chia-s%E1%BA%BB-file" aria-hidden="true"><span class="octicon octicon-link"></span></a>Progam 3: Chia sẻ file</h3>

<p>Xây dựng chương trình mã hóa file cho phép nhiều người dùng có thể giải mã.
<br>Giả sử người dùng <strong>A</strong> muốn mã hóa file <em>f</em> cho phép cả người dùng <strong>B</strong> và <strong>C</strong> có thể giải mã. Chị ta làm như sau:</p>

<ul>
<li>Sinh ngẫu nhiên khóa <code>k</code> và mã hoá file <em>f</em> dùng hệ mã đối xứng an toàn <code>(E, D)</code>. Ta được file
<br>                 <code>g = E(k, f)</code>
&gt; Ví dụ: <strong>E</strong> có thể là <code>AES-CBC mode</code> hoặc <code>AES-CRT mode</code>.</li>
<li>Dùng sở đồ <code>RSA-OAEP</code> với khóa công khai của người dùng <strong>A</strong>, <strong>B</strong> và <strong>C</strong> để mã hóa khóa <code>k</code>
thành <code>kA</code>, <code>kB</code> và <code>kC</code>, tương ứng cho mỗi người. Ghép file <code>g</code> với <code>kA</code>, <code>kB</code> và <code>kC</code> ta được file
<br>                 <code>x = g‖kA‖kB‖kC</code>
<br>Người dùng <strong>B</strong> (tương ứng <strong>C</strong>) có thể tính <code>k</code> từ file <code>x</code> và khóa bí mật <code>kB</code> (tương ứng <code>kC</code> ). Từ đó
chị ta giải mã <code>f = D(k, g)</code>.</li>
</ul>
              <footer>
                  <p>This project is maintained by <a href="https://github.com/Franciscodesign">Franciscodesign</a></p>
                  <p>Pins: <a href="https://www.pinterest.com/franciscokimson/">@franciscokimson</a></p>
                  <p>Twitter: <a href="https://twitter.com/Franciscokimson">@Franciscokimson</a></p>
                  <iframe src="//www.facebook.com/plugins/follow?href=https%3A%2F%2Fwww.facebook.com%2Fkimdinhson.ict&amp;layout=standard&amp;show_faces=true&amp;colorscheme=light&amp;width=500&amp;height=80" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:300px; height:80px;" allowTransparency="true"></iframe>
              </footer>
      </section>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>
